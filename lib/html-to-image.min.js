!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).htmlToImage={})}(this,(function(e){"use strict";var t={};function n(e){var n={};return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().split("-").forEach((function(e,t){n[e]=t?"-".concat(e):e})),Object.values(n).join("-")}function o(e,t){return(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t)}function r(e,t){var n=o(e,"".concat(t,"-left-width")),r=o(e,"".concat(t,"-right-width"));return e["client".concat("width"===t?"Width":"Height")]+(parseFloat(n.replace("px",""))||0)+(parseFloat(r.replace("px",""))||0)}function i(e){var t,n=window.devicePixelRatio||1;try{t=Math.max(n,(window.screen.availWidth||window.innerWidth)/360)}catch(e){t=n}return t}var a={};function c(e,t){var n=e.replace(/\?.*/,"");return t.cacheBust&&(n+="?".concat((new Date).getTime())),n}async function l(e,t){var n=!1;t.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+`${(new Date).getTime()}`);try{var o=await fetch(e,t.fetchRequestInit);404===o.status&&(n=!0);var r=await o.blob();return n&&r.type.startsWith("text/html")?null:r}catch(e){return null}}async function u(e){var t=await fetch(e,{method:"HEAD"});return t.headers.get("Content-Type")||""}async function s(e,t){var n=c(e,t);if(null!=a[n])return a[n];var o=t.imagePlaceholder||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r=null;try{if(!(r=await l(e,{fetchRequestInit:t.fetchRequestInit})))return o}catch(e){return o}var i=r.type;if("image/svg+xml"===i)i="image/svg+xml";else if(!i||"application/octet-stream"===i)try{i=await u(e)}catch(e){i=""}return a[n]=await new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){e(n.result)},n.onerror=t,n.readAsDataURL(r)})),a[n]}function d(e){return new Promise((function(t,n){var o=new Image;o.onload=function(){t(o)},o.onerror=n,o.crossOrigin="anonymous",o.decoding="sync",o.src=e}))}function f(e,t){if(e instanceof t)return!0;var n=Object.getPrototypeOf(e);return null!==n&&(n.constructor.name===t.name||f(n,t))}async function p(e){var t=e.toDataURL();return"data:,"===t?e.cloneNode(!1):d(t)}async function m(e){var t=document.createElement("canvas");t.width=e.clientWidth,t.height=e.clientHeight;var n=t.getContext("2d",{willReadFrequently:!0});try{n.drawImage(e,0,0,t.width,t.height)}catch(e){}var o=t.toDataURL();return"data:,"===o?t.cloneNode(!1):d(o)}async function h(e){try{if(null!=e&&null!=e.contentDocument&&null!=e.contentDocument.body)return g(e.contentDocument.body,{})}catch(e){}return e.cloneNode(!1)}async function y(e,t){return f(e,HTMLCanvasElement)?p(e):f(e,HTMLVideoElement)?m(e):f(e,HTMLIFrameElement)?h(e):e.cloneNode(!1)}function g(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then((function(e){return y(e,t)})).then((function(o){return function(e,o,t){var r;if(0===(r=e.childNodes).length)return Promise.resolve(o);for(var i=[],a=0,c=r.length;a<c;a++)i.push(r[a]);return i.reduce((function(e,n){return e.then((function(){return g(n,t,!1)})).then((function(e){e&&o.appendChild(e)}))}),Promise.resolve()).then((function(){return o}))}(e,o,t)})).then((function(t){return function(e,t){if(f(t,Element)){t.style.setProperty("pointer-events","none","important"),t.setAttribute("webkit-font-smoothing","antialiased"),t.setAttribute("font-smoothing","antialiased");var n=window.getComputedStyle(e);Array.from(n).forEach((function(e){return t.style.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))})),function(e,t){(function(e,t,n){var r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var a=function(){var e=Math.random().toString(36).substring(2,15),t=Math.random().toString(36).substring(2,15);return"__pseudo_".concat(e,"_").concat(t)}(),c=document.createElement("style");c.appendChild(function(e,t,n){var r=".".concat(e,":").concat(t),i=n.cssText?function(e){return"".concat(e.cssText," content: '").concat(e.getPropertyValue("content").replace(/'|"/g,""),"';")}(n):function(e){return Array.from(e).map((function(t){var n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return"".concat(t,": ").concat(n," ").concat(o?"!important":"",";")})).join(" ")}(n);return document.createTextNode("".concat(r,"{").concat(i,"}"))}(a,n,r)),t.className="".concat(t.className," ").concat(a),t.appendChild(c)}})(e,t,":before"),(function(e,t,n){var r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var a=function(){var e=Math.random().toString(36).substring(2,15),t=Math.random().toString(36).substring(2,15);return"__pseudo_".concat(e,"_").concat(t)}(),c=document.createElement("style");c.appendChild(function(e,t,n){var r=".".concat(e,":").concat(t),i=n.cssText?function(e){var t=e.getPropertyValue("content");return"".concat(e.cssText," content: '").concat(t.replace(/'|"/g,""),"';")}(n):function(e){return Array.from(e).map((function(t){var n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return"".concat(t,": ").concat(n," ").concat(o?"!important":"",";")})).join(" ")}(n);return document.createTextNode("".concat(r,"{").concat(i,"}"))}(a,n,r)),t.className="".concat(t.className," ").concat(a),t.appendChild(c)}})(e,t,":after")}return t}(e,t)}))}var v=/url\((['"]?)(.*?)\1\)/g;async function w(e,t){var n=t.imagePlaceholder,o=function(e){var t={};return{get:async function(n){var o=c(n,e);if(null!=t[o])return t[o];var r=await s(n,e);return t[o]=r,r}}}({imagePlaceholder:n});if(f(e,HTMLImageElement))await function(e,t){if(f(e,HTMLImageElement)&&!e.src.startsWith("data:")){var n=e.src,o=await t.get(n);await new Promise((function(t,n){e.onload=t,e.onerror=n,e.srcset="",e.src=o}))}};var r=Array.from(e.querySelectorAll("*"));r.forEach((function(e){var t,n;null!=(t=e.style)&&t.getPropertyValue("background")&&e.style.setProperty("background",(null===(n=e.style)?void 0:n.getPropertyValue("background")).replace(v,(function(e,t,n){if(n.startsWith("data:"))return e;var o=c(n,options);return'url("'.concat(a[o]||n,'")')})))})),await Promise.all(r.map((function(e){return function(e,t){return f(e,HTMLImageElement)&&!e.src.startsWith("data:")?(Promise.resolve(e.src).then(t.get).then((function(t){return new Promise((function(n,o){e.onload=n,e.onerror=o,e.srcset="",e.src=t}))}))):Promise.resolve()}(e,o)}))).then((function(){return Promise.resolve(e)}))}function b(e,t){var n,o;return n=e,o=t,Promise.resolve(n).then((function(e){return function(e,t){var o=t||{};return Promise.resolve(e.ownerDocument).then((function(t){return g(e,o,!0).then((function(e){return null===e?Promise.resolve(""):w(e,o).then((function(e){var i,c,l,u;return i=e,c=r(n,"width"),l=r(n,"height"),Promise.resolve(i).then(d).then((function(e){var n=o.quality;return function(e,n,o,r){var a=document.createElement("canvas");a.width=n*r,a.height=o*r,a.style.width="".concat(n,"px"),a.style.height="".concat(o,"px");var c=a.getContext("2d");return c.scale(r,r),c.drawImage(e,0,0),a.toDataURL("image/png",t)}()})))}))}))}))}))}async function x(e,t={}){var n,o,a=(n=await async function(e,t={}){var n,o,a,c,l,f,p,m,h,y,b,x,E,S,L,A,T;return n=e,Promise.resolve(n.ownerDocument).then((function(e){return g(n,o=t,!0).then((function(e){return null===e?Promise.resolve(""):w(e,o).then((function(e){return Promise.resolve(e)})).then((function(e){var t,n,o,i;return function(e,t,n){var o=document.createElement("foreignObject");o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("externalResourcesRequired","true");var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns","image/svg+xml"),r.setAttribute("viewBox","".concat(0," ").concat(0," ").concat(t," ").concat(n)),r.appendChild(o);var i=document.createElement("div");return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),i.appendChild(e),o.appendChild(i),new XMLSerializer().serializeToString(r)}(e,t,n)})(e,a=r(n,"width"),c=r(n,"height"))})).then((function(e){return(l=e,f="image/svg+xml","data:".concat(f,";base64,").concat((p=l,btoa(unescape(encodeURIComponent(p))))))}))}))},t),d((p=a,m=t,o=await d(p),h=m.canvas||document.createElement("canvas"),y=r(e,"width"),b=r(e,"height"),x=m.pixelRatio||i(),h.width=y*x,h.height=b*x,m.canvas||(h.style.width="".concat(y,"px"),h.style.height="".concat(b,"px")),E=h.getContext("2d"),m.backgroundColor&&(E.fillStyle=m.backgroundColor,E.fillRect(0,0,h.width,h.height)),E.drawImage(o,0,0,h.width,h.height),h));return S=a,d((A=await d(S),T=(L=document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),L.width=A.width,L.height=A.height,T.drawImage(A,0,0,L.width,L.height),L)).then((function(e){return new Promise((function(t){var n=window.atob(e.toDataURL().split(",")[1]),o=n.length,r=new Uint8Array(o);for(var i=0;i<o;i++)r[i]=n.charCodeAt(i);t(new Blob([r],{type:"image/png"}))}))}))}e.toBlob=x,e.toCanvas=function(e,t={}){var n,o,a,c,l,u,s,d,f,p,m;return n=e,o=t,Promise.resolve(n).then((function(e){return x(e,{rejectMissing:!0,onclone:function(e,t){t.removeAttribute("id"),t.removeAttribute("class"),t.removeAttribute("style")}}).then((function(e){return URL.createObjectURL(e)}))}))},e.toJpeg=function(e,t={}){var n,o;return n=e,o=t,Promise.resolve(n).then((function(e){return b(e,o).then(d)})).then((function(e){var n=o.quality,r=document.createElement("canvas");r.width=e.width,r.height=e.height;var i=r.getContext("2d");return i.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}))},e.toPixelData=async function(e,t={}){var n,o,a,c,l,u,s,d,f;return n=e,o=t,d((c=await (a=async function(e,t={}){var n=t.filter,o=function(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then((function(e){return y(e,t)})).then((function(o){return function(e,o,t){var r;if(0===(r=e.childNodes).length)return Promise.resolve(o);for(var i=[],a=0,c=r.length;a<c;a++)i.push(r[a]);return i.reduce((function(e,n){return e.then((function(){return function(e,t,n){var o=n.filter,r=function(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then((function(e){return y(e,t)})).then((function(o){return function(e,o,t){var r;if(0===(r=e.childNodes).length)return Promise.resolve(o);for(var i=[],a=0,c=r.length;a<c;a++)i.push(r[a]);return i.reduce((function(e,n){return e.then((function(){return r(n,t,!1)})).then((function(e){e&&o.appendChild(e)}))}),Promise.resolve()).then((function(){return o}))}(e,o,t)})).then((function(t){return function(e,t){if(f(t,Element)){t.style.setProperty("pointer-events","none","important"),t.setAttribute("webkit-font-smoothing","antialiased"),t.setAttribute("font-smoothing","antialiased");var n=window.getComputedStyle(e);Array.from(n).forEach((function(e){return t.style.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))})),function(e,t){(function(e,t,n){var r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var a=function(){var e=Math.random().toString(36).substring(2,15),t=Math.random().toString(36).substring(2,15);return"__pseudo_".concat(e,"_").concat(t)}(),c=document.createElement("style");c.appendChild(function(e,t,n){var r=".".concat(e,":").concat(t),i=n.cssText?function(e){return"".concat(e.cssText," content: '").concat(e.getPropertyValue("content").replace(/'|"/g,""),"';")}(n):function(e){return Array.from(e).map((function(t){var n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return"".concat(t,": ").concat(n," ").concat(o?"!important":"",";")})).join(" ")}(n);return document.createTextNode("".concat(r,"{").concat(i,"}"))}(a,n,r)),t.className="".concat(t.className," ").concat(a),t.appendChild(c)}})(e,t,":before"),(function(e,t,n){var r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var a=function(){var e=Math.random().toString(36).substring(2,15),t=Math.random().toString(36).substring(2,15);return"__pseudo_".concat(e,"_").concat(t)}(),c=document.createElement("style");c.appendChild(function(e,t,n){var r=".".concat(e,":").concat(t),i=n.cssText?function(e){var t=e.getPropertyValue("content");return"".concat(e.cssText," content: '").concat(t.replace(/'|"/g,""),"';")}(n):function(e){return Array.from(e).map((function(t){var n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return"".concat(t,": ").concat(n," ").concat(o?"!important":"",";")})).join(" ")}(n);return document.createTextNode("".concat(r,"{").concat(i,"}"))}(a,n,r)),t.className="".concat(t.className," ").concat(a),t.appendChild(c)}})(e,t,":after")}return t}(e,t)}));(n,t,o)})).then((function(e){e&&o.appendChild(e)}))}),Promise.resolve()).then((function(){return o}))}(e,o,t)})).then((function(t){return function(e,t){if(f(t,Element)){t.style.setProperty("pointer-events","none","important"),t.setAttribute("webkit-font-smoothing","antialiased"),t.setAttribute("font-smoothing","antialiased");var n=window.getComputedStyle(e);Array.from(n).forEach((function(e){return t.style.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))})),function(e,t){(function(e,t,n){var r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var a=function(){var e=Math.random().toString(36).substring(2,15),t=Math.random().toString(36).substring(2,15);return"__pseudo_".concat(e,"_").concat(t)}(),c=document.createElement("style");c.appendChild(function(e,t,n){var r=".".concat(e,":").concat(t),i=n.cssText?function(e){return"".concat(e.cssText," content: '").concat(e.getPropertyValue("content").replace(/'|"/g,""),"';")}(n):function(e){return Array.from(e).map((function(t){var n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return"".concat(t,": ").concat(n," ").concat(o?"!important":"",";")})).join(" ")}(n);return document.createTextNode("".concat(r,"{").concat(i,"}"))}(a,n,r)),t.className="".concat(t.className," ").concat(a),t.appendChild(c)}})(e,t,":before"),(function(e,t,n){var r=window.getCustom Sty...,o=document.createElement("canvas"),r=o.getContext("2d",{willReadFrequently:!0});return o.width=c.width,o.height=c.height,r.drawImage(c,0,0,o.width,o.height),r.getImageData(0,0,o.width,o.height).data)},e.toPng=b,e.toSvg=function(e,t={}){var n,o,a,c;return n=e,o=t,Promise.resolve(n.ownerDocument).then((function(e){return g(n,o,!0).then((function(e){return null===e?Promise.resolve(""):w(e,o).then((function(e){return a=e,c=r(n,"width"),Promise.resolve("").then((function(){var e,t;return e=new XMLSerializer().serializeToString(function(e,t,n){var o=document.createElement("foreignObject");o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("externalResourcesRequired","true");var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns","image/svg+xml"),r.setAttribute("viewBox","".concat(0," ").concat(0," ").concat(t," ").concat(n)),r.appendChild(o);var i=document.createElement("div");return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),i.appendChild(e),o.appendChild(i),r}(a,c,r(n,"height"))),t=encodeURIComponent(e),"data:image/svg+xml;charset=utf-8,".concat(t)}))}))}))}))},Object.defineProperty(e,"__esModule",{value:!0})}));
